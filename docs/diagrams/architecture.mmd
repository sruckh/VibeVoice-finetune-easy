%% VibeVoice Training Architecture
%% Date: 2026-02-12

flowchart TB
    classDef default fill:#e1f5fe,stroke:#0288d1,stroke-width:2px,color:#01579b
    classDef input fill:#e3f2fd,stroke:#0288d1,stroke-width:2px,color:#01579b
    classDef prep fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px,color:#01579b
    classDef llm fill:#fff3e0,stroke:#ef6c00,stroke-width:2px,color:#01579b
    classDef diff fill:#fce4ec,stroke:#c62828,stroke-width:2px,color:#01579b
    classDef loss fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#01579b
    classDef output fill:#e8eaf6,stroke:#455a64,stroke-width:2px,color:#01579b

    Audio["Audio Input"]:::input
    Text["Text Transcript"]:::input
    Voice["Voice Prompt"]:::input
    
    AcTok["Acoustic Tokenizer"]:::prep
    SemTok["Semantic Tokenizer"]:::prep
    
    Layers["Transformer Layers"]:::llm
    LoRA["LoRA Adapters"]:::llm
    
    D1["Acoustic Connector"]:::diff
    D2["Semantic Connector"]:::diff
    D3["DDPM Denoiser"]:::diff
    
    Loss1["Cross-Entropy Loss"]:::loss
    Loss2["MSE Loss"]:::loss
    
    Pred["Predicted Tokens"]:::output
    Check["Model Checkpoint"]:::output

    Audio --> AcTok & SemTok
    Text --> Layers
    Voice --> Layers
    AcTok --> D1
    SemTok --> D2
    Layers --> LoRA
    Layers --> Loss1
    D1 & D2 --> D3
    D3 --> Loss2
    Loss1 --> Check
    Loss2 --> Check
    Layers --> Pred
